<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Class Training System{% endblock %}</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/w3.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .w3-bar, .w3-sidebar, .w3-button, .w3-hover-deep-purple { background-color: #5c0e2a !important; color: #fff !important; }
        .w3-sidebar { width: 250px; }
        .w3-bar .w3-bar-item { color: #fff !important; }
        .w3-bar .w3-bar-item.w3-hover-white:hover { color: #5c0e2a !important; background: #fff !important; }
        .w3-bar .w3-bar-item.w3-hover-deep-purple:hover { background: #7a1d3e !important; }
        .w3-sidebar .w3-bar-item.w3-hover-white:hover { color: #5c0e2a !important; background: #fff !important; }
        .w3-sidebar .w3-bar-item.w3-hover-deep-purple:hover { background: #7a1d3e !important; }
        .w3-sidebar .w3-bar-item.active { background: #7a1d3e !important; }
        .w3-main { margin-left: 0; transition: margin-left .3s; }
        @media (min-width: 601px) { .w3-main { margin-left: 0; } }
        .w3-overlay { cursor: pointer; }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body>


    <!-- Sidebar: always visible, fixed left -->
    <nav class="w3-sidebar w3-bar-block w3-card" style="z-index:5;width:250px;position:fixed;top:0;left:0;height:100vh;overflow:auto;">
        <div class="w3-container w3-center w3-padding-16">
            <span class="w3-xlarge"><b>Class Training System</b></span>
        </div>
        {% if current_user.is_authenticated %}
            <a href="{{ url_for('main.dashboard') }}" class="w3-bar-item w3-button">Dashboard</a>
            {% if current_user.is_teacher() %}
                <a href="{{ url_for('admin.index') }}" class="w3-bar-item w3-button">Admin</a>
            {% endif %}
            <a href="{{ url_for('auth.logout') }}" class="w3-bar-item w3-button">Logout ({{ current_user.username }})</a>
            <hr style="margin: 10px 0; border-color: #fff2;">
            <div class="w3-dropdown-hover">
                <button class="w3-button">Courses <i class="fa fa-caret-down"></i></button>
                <div class="w3-dropdown-content w3-bar-block w3-card-4" style="min-width:220px;">
                    <a href="{{ url_for('courses.list_courses') }}" class="w3-bar-item w3-button">All Courses</a>
                    {% if current_user.is_authenticated %}
                        <div class="w3-bar-item" style="font-weight:bold; color:#5c0e2a; background: #f5f5f5; cursor:default;">My Courses</div>
                        {% if current_user.is_teacher() %}
                            {% for course in current_user.courses_created %}
                                <a href="{{ url_for('courses.view_course', course_id=course.id) }}" class="w3-bar-item w3-button">{{ course.title }}</a>
                            {% endfor %}
                        {% else %}
                            {% for enrollment in current_user.enrollments %}
                                <a href="{{ url_for('courses.view_course', course_id=enrollment.course.id) }}" class="w3-bar-item w3-button">{{ enrollment.course.title }}</a>
                            {% endfor %}
                        {% endif %}
                    {% endif %}
                    {% if current_user.is_teacher() %}
                        <a href="{{ url_for('courses.create_course') }}" class="w3-bar-item w3-button">Create New Course</a>
                    {% endif %}
                </div>
            </div>
        {% else %}
            <a href="{{ url_for('auth.login') }}" class="w3-bar-item w3-button">Login</a>
            <a href="{{ url_for('auth.register') }}" class="w3-bar-item w3-button">Register</a>
        {% endif %}
    </nav>



    <!-- Top bar -->
    <div class="w3-bar w3-top w3-large w3-card" style="margin-left:250px;">
        <span class="w3-bar-item">Class Training System</span>
    </div>

    <div class="w3-main" style="margin-top:52px; margin-left:250px; padding-left:32px;">
        {% block fullwidth_content %}{% endblock %}
        <div class="w3-container" style="max-width:1200px;">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="flash-messages">
                        {% for category, message in messages %}
                            <div class="alert alert-{{ category }}">{{ message }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}
            {% block content %}{% endblock %}
        </div>
    </div>

    <footer class="w3-container w3-center w3-margin-top" style="padding:32px 0 16px 0; background:#f5f5f5; color:#5c0e2a;">
        <p>&copy; 2025 Class Training System. Built for programming education.</p>
    </footer>


    {% block extra_js %}{% endblock %}
</body>
</html>
