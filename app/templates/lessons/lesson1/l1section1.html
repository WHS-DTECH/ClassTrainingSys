render@srv-d53ovsn5r7bs73dvdt20-56897699d8-9rb42:~/project/src$ flask db upgrade
[ADMIN BOOTSTRAP] Admin user exists. Resetting password and role...
[ADMIN BOOTSTRAP] Admin user vanessapringle@westlandhigh.school.nz ensured with password (hidden) and role teacher.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> e9c0c2e251cb, Initial migration after Alembic reset
Traceback (most recent call last):
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.ForeignKeyViolation: insert or update on table "comment_feedback" violates foreign key constraint "comment_feedback_section_id_fkey"
DETAIL:  Key (section_id)=(1) is not present in table "sections".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/render/project/src/.venv/bin/flask", line 8, in <module>
    sys.exit(main())
             ~~~~^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/flask/cli.py", line 1064, in main
    cli.main()
    ~~~~~~~~^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/click/core.py", line 1406, in main
    rv = self.invoke(ctx)
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/click/core.py", line 1873, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/click/core.py", line 1873, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/click/core.py", line 1269, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/click/core.py", line 824, in invoke
    return callback(*args, **kwargs)
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/click/decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/flask/cli.py", line 358, in decorator
    return __ctx.invoke(f, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/click/core.py", line 824, in invoke
    return callback(*args, **kwargs)
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/flask_migrate/cli.py", line 150, in upgrade
    _upgrade(directory, revision, sql, tag, x_arg)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/flask_migrate/__init__.py", line 111, in wrapped
    f(*args, **kwargs)
    ~^^^^^^^^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/flask_migrate/__init__.py", line 200, in upgrade
    command.upgrade(config, revision, sql=sql, tag=tag)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/command.py", line 483, in upgrade
    script.run_env()
    ~~~~~~~~~~~~~~^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/script/base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/util/pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/util/pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/opt/render/project/src/migrations/env.py", line 113, in <module>
    run_migrations_online()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/render/project/src/migrations/env.py", line 107, in run_migrations_online
    context.run_migrations()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 8, in run_migrations
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/runtime/environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/runtime/migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
    ~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/render/project/src/migrations/versions/e9c0c2e251cb_initial_migration_after_alembic_reset.py", line 30, in upgrade
    with op.batch_alter_table('comment_feedback', schema=None) as batch_op:
         ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/render/project/python/Python-3.13.4/lib/python3.13/contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/operations/base.py", line 410, in batch_alter_table
    impl.flush()
    ~~~~~~~~~~^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/operations/batch.py", line 115, in flush
    fn(*arg, **kw)
    ~~^^^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/ddl/impl.py", line 404, in add_constraint
    self._exec(schema.AddConstraint(const))
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/alembic/ddl/impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/sql/ddl.py", line 187, in _execute_on_connection
    return connection._execute_ddl(
           ~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1530, in _execute_ddl
    ret = self._execute_context(
        dialect,
    ...<4 lines>...
        compiled,
    )
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/render/project/src/.venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "comment_feedback" violates foreign key constraint "comment_feedback_section_id_fkey"
DETAIL:  Key (section_id)=(1) is not present in table "sections".

[SQL: ALTER TABLE comment_feedback ADD FOREIGN KEY(section_id) REFERENCES sections (id)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
render@srv-d53ovsn5r7bs73dvdt20-56897699d8-9rb42:~/project/src$ {% extends 'base.html' %}
{% block title %}Section 1: Python Comments - Best Practices{% endblock %}
{% block content %}
<div class="lesson-header">
    <div class="lesson-breadcrumb">
        <a href="{{ url_for('courses.list_courses') }}">Courses</a> &gt;
        <a href="{{ url_for('courses.view_course', course_id=lesson.course_id) }}">Module 1: Commenting</a> &gt;
        Section 1: Python Comments - Best Practices
    </div>
    <h1>Section 1: Python Comments - Best Practices</h1>
</div>
<div class="lesson-main-box">
    <p>Follow these conventions to write clear, effective comments in your Python code:</p>
    <div class="lesson-conventions-grid">
        <div class="lesson-conventions-col">
            <h3>Conventions 1–5</h3>
            <ul>
                <li><b>Convention 1:</b> Use complete sentences for comments.<br><span class="lesson-convention-detail">Write comments as full sentences to improve clarity and professionalism.</span>
                    <pre class="lesson-example"># This function adds two numbers together and returns the result.
def add(a, b):
    return a + b
</pre>
                </li>
                <li><b>Convention 2:</b> Keep comments concise and relevant.<br><span class="lesson-convention-detail">Only include information that helps understand the code; avoid unnecessary details.</span>
                    <pre class="lesson-example"># Add two numbers
def add(a, b):
    return a + b
</pre>
                </li>
                <li><b>Convention 3:</b> Update comments when code changes.<br><span class="lesson-convention-detail">Always revise comments to match the current code to prevent confusion.</span>
                    <pre class="lesson-example"># This function multiplies two numbers (updated from addition)
def multiply(a, b):
    return a * b
</pre>
                </li>
                <li><b>Convention 4:</b> Avoid obvious comments.<br><span class="lesson-convention-detail">Don't state what is already clear from the code itself.</span>
                    <pre class="lesson-example"># This is obvious and should be avoided
# Add a and b
def add(a, b):
    return a + b
</pre>
                </li>
                <li><b>Convention 5:</b> Use proper grammar and spelling.<br><span class="lesson-convention-detail">Well-written comments are easier to read and look more professional.</span>
                    <pre class="lesson-example"># Calculate the sum of two numbers
def add(a, b):
    return a + b
</pre>
                </li>
            </ul>
        </div>
        <div class="lesson-conventions-col">
            <h3>Conventions 6–7</h3>
            <ul>
                <li><b>Convention 6:</b> Explain why, not just what.<br><span class="lesson-convention-detail">Describe the reasoning or intent behind code decisions, not just what the code does.</span>
                    <pre class="lesson-example"># We use a loop here to handle multiple inputs efficiently
for value in values:
    process(value)
</pre>
                </li>
                <li><b>Convention 7:</b> Use TODO/FIXME tags for future work or known issues.<br><span class="lesson-convention-detail">Mark places in the code that need attention or improvement.</span>
                    <pre class="lesson-example"># TODO: Handle negative numbers
# FIXME: This function fails if b is zero
def divide(a, b):
    return a / b
</pre>
                </li>
            </ul>
        </div>
    </div>
    <div class="lesson-back-link">
        <a href="{{ url_for('courses.view_course', course_id=lesson.course_id) }}">Back to Course</a>
    </div>
</div>
{% endblock %}
